<div class="song-item dark-card">
    <div class="d-flex p-3 song-info dark-card">
        <div class="col-1">
            <span class="song-number dark-text">{{ forloop.counter }}.</span>
        </div>
        <p class="col-3">
            <strong><a class="song-link dark-text" href="{% url 'song_detail' song.id %}">{{ song.title }}</a></strong>
            <br/>
            {% for artist in song.artists.all %}
                <a href="{% url 'artist_detail' artist.id %}">{{ artist.artist_name }}</a>
                {% if not forloop.last %}
                    , 
                {% endif %}
            {% endfor %}
        </p>
        <!-- Fav Icon -->
        <div class="col-2">
            {% if song in favorite %}
                <form action="{% url 'remove_favorite' song.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" style="border: none; background: none;" onclick="refreshPage()">
                        <i class="fas fa-solid fa-heart play-icon dark-text" style="color: red;"></i>
                    </button>
                </form>
                {% else %}
                <form action="{% url 'add_favorite' song.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" style="border: none; background: none;" onclick="refreshPage()">
                        <i class="far fa-heart play-icon dark-text" style="color: red;"></i>
                    </button>
                </form>
            {% endif %}
        </div>
        <!-- Download Icon -->
        <div class="col-2">
            <div class="popup" onclick="copySongLink('{% if request.is_secure %}https{% else %}http{% endif %}','{{ request.META.HTTP_HOST }}','songs','{{ song.id }}')" style="border: none; background: none;">
                <p><button class="btn active rounded-circle btn-social mx-1" style="transition: transform 0.2s;"><i class="fas fa-solid fa-copy play-icon dark-text"></i></button></p>
                <span class="popuptext" id="copyLink">Copy</span>
            </div> 
        </div>
        <!-- Audio Player -->
        <div class="audio-controls">
            <div class="row">
                <div class="col-1">
                    <i class="fas fa-repeat play-icon dark-text" id="repeat_{{ song.id }}" onclick="toggleRepeat('{{ song.id }}')"></i>
                </div>
                <div class="col-1">
                    <audio class="mysound" id="mysound_{{ song.id }}">
                        <source src="{{ song.audio_file.url }}" type="audio/mp3">
                    </audio>
                </div>
                <div class="col">
                    <!-- <i class="fas fa-play play-icon dark-text" id="icon_{{ song.id }}" onclick="toggleAudio('{{ song.id }}')"></i> -->
                    {% if user.is_authenticated %}
                        <i class="fas fa-play play-icon dark-text" id="icon_{{ song.id }}" onclick="toggleAudio('{{ song.id }}')"></i>
                    {% else %}
                        <i class="fas fa-play play-icon dark-text" id="icon_{{ song.id }}"  data-toggle="modal" data-target="#loginModal"></i>
                    {% endif %}
                </div>
                <div class="col">
                    <div class="song-duration dark-text">
                        <span class="currentTime dark-text" id="currentTime_{{ song.id }}">0:00</span> / <span class="totalDuration dark-text" id="totalDuration_{{ song.id }}">0:00</span>
                    </div>
                </div>
                <div class="col popup" onmouseover="popUp()">
                    <span><i class="fas fa-volume-up play-icon dark-text" id="vol_icon_{{ song.id }}"></i></span>
                    <div class="popuptext" id="myPopup">
                      <input type="range" class="volume-progress" id="volumeRange_{{ song.id }}" min="0" max="1" step="0.01" oninput="changeVolume('{{ song.id }}', this.value)">
                    </div>
                </div>
            </div>
            <input type="range" class="song-progress" id="progress_{{ song.id }}" min="0" value="0" step="1" oninput="seekSong('{{ song.id }}', this.value)">
        </div>
    </div>
</div>